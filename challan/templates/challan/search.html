<!DOCTYPE html>
<html>
<head>
    <title>e-Challan Search</title>
    <style>
        body {
            font-family: Arial;
            background:#f4f6f8;
            padding:30px;
        }
        .box {
            background:white;
            padding:20px;
            border-radius:8px;
        }
        img {
            max-width:300px;
            margin-top:10px;
            border:1px solid #ccc;
            border-radius:5px;
        }
        .challan {
            border-top:1px solid #ddd;
            margin-top:20px;
            padding-top:15px;
        }
        iframe {
            margin-top:10px;
            border-radius:6px;
        }
    </style>
</head>
<body>

<div class="box">
    <h2>üîç Search e-Challan</h2>

    <form method="get">
        <input type="text" name="q" placeholder="e-Challan No or Vehicle No" required>
        <button type="submit">Search</button>
    </form>

    {% if query %}
        <h3>Results for "{{ query }}"</h3>
    {% endif %}

    {% for c in challans %}
        <div class="challan">
            <p><b>e-Challan No:</b> {{ c.echallan_number }}</p>
            <p><b>Vehicle No:</b> {{ c.violation.vehicle_number }}</p>
            <p><b>Fine Amount:</b> ‚Çπ{{ c.fine_amount }}</p>
            <p><b>Location:</b> {{ c.violation.location }}</p>
            <p><b>Date & Time:</b> {{ c.issued_at }}</p>

            <!-- üìç GOOGLE MAP -->
            {% if c.violation.latitude and c.violation.longitude %}
                <h4>üìç Violation Location</h4>
                <iframe
                    width="100%"
                    height="250"
                    frameborder="0"
                    style="border:0"
                    src="https://www.google.com/maps?q={{ c.violation.latitude }},{{ c.violation.longitude }}&output=embed"
                    allowfullscreen>
                </iframe>
            {% endif %}

            <h4>üì∑ Violation Evidence</h4>
            {% if c.violation.image %}
                <img src="{{ c.violation.image.url }}">
            {% endif %}

            {% if c.violation.plate_image %}
                <img src="{{ c.violation.plate_image.url }}">
            {% endif %}
        </div>
    {% empty %}
        {% if query %}
            <p>No challans found.</p>
        {% endif %}
    {% endfor %}
</div>

</body>
</html>
